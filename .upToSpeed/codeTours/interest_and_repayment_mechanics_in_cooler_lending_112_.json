{"title":"Interest and Repayment Mechanics in Cooler Lending","id":"8teKR/42laP9oo8NAYPKCn09sXtXV2d5x0Twfq4J3sI=","position":7,"steps":[{"type":"textOnly","description":"The **Cooler lending facility** enables **fixed-term loans** using `gOHM` as collateral. Let's explore how interest is calculated, repayments are processed, and loan states are updated.","title":"","id":"575"},{"type":"highlight","description":"The `interestFor` function calculates the interest for a loan. It takes the loan amount, interest rate, and duration as inputs. The interest is computed by first calculating the interest rate for the loan duration, then applying it to the loan amount.","file":"Cooler/src/Cooler.sol","highlight":[{"start":396,"end":399}],"title":"","id":"576"},{"type":"highlight","description":"The `Request` struct defines the terms of a **loan request**. It includes the **loan amount**, **interest rate**, **loan-to-collateral ratio**, and **duration**. These parameters are used to calculate interest and manage the loan lifecycle.","file":"Cooler/src/Cooler.sol","highlight":[{"start":33,"end":39}],"title":"","id":"577"},{"type":"highlight","description":"The **`Loan`** struct represents an active loan. It includes the original request terms and additional fields to track the current loan state, such as the amount owed, collateral held, and expiry time.","file":"Cooler/src/Cooler.sol","highlight":[{"start":42,"end":51}],"title":"","id":"578"},{"type":"highlight","description":"The `repayLoan` function handles loan repayments. It checks if the loan has expired, caps the repayment amount to the outstanding debt, and calculates the amount of collateral to be returned based on the repayment.","file":"Cooler/src/Cooler.sol","highlight":[{"start":151,"end":159}],"title":"","id":"579"},{"type":"highlight","description":"After processing the repayment, the loan state is updated. The **outstanding amount** and **collateral** are reduced, and the **repayment** is either sent directly to the lender or marked as unclaimed, depending on the loan settings.","file":"Cooler/src/Cooler.sol","highlight":[{"start":162,"end":172}],"title":"","id":"580"},{"type":"highlight","description":"The function calculates the new collateral required and the new debt amount. The **`newCollateralFor`** function (line 199) determines if additional collateral is needed, while **`interestFor`** (line 200) computes the new debt including interest for the extended period.","file":"Cooler/src/Cooler.sol","highlight":[{"start":198,"end":200}],"title":"","id":"587"},{"type":"highlight","description":"The **`claimDefaulted`** function handles defaulted loans. It checks if the loan has indeed defaulted, transfers the collateral to the lender, and removes the loan from storage.","file":"Cooler/src/Cooler.sol","highlight":[{"start":318,"end":325}],"title":"","id":"582"},{"type":"textOnly","description":"That concludes our tour of the interest calculations and repayment handling in the Cooler lending facility.","title":"","id":"584"}]}